

<html>
<head>
<title>Least Path Cost</title>
<meta name="description" content="Least Path Cost">
<meta name="keywords" content="htmlatex">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="STYLESHEET" href="htmlatex.css">
</head>
<body lang="EN" bgcolor="#FFFFFF">

<h1><br clear="ALL"><center><table bgcolor="#0060F0"><tr><td><b><font size="5" color="#C0FFFF">&nbsp;<a name="SECTION0001000000000000000000">
Least Path Cost</a>&nbsp;</font></b></td></tr></table></center>
</h1>

<p>
Given a positive integer <img width="19" height="15" align="BOTTOM" border="0" src="685img1.gif" alt="$\Delta$">
(

<img width="118" height="32" align="MIDDLE" border="0" src="685img2.gif" alt="$0 < \Delta < 10000$">), which is called the
<em>overhead</em>, and <i>M</i> (

<img width="105" height="32" align="MIDDLE" border="0" src="685img3.gif" alt="$0 < M \le 200$">)
straight line segments in a
two-dimensional plane with the following properties:
<dl compact="">
<dt>1.
<dd>each line segment has a height, which is a positive integer;
<dt>2.
<dd>two line segments only intersect with each other on endpoints;
<dt>3.
<dd>no two line segments are overlapped.
</dd></dt></dd></dt></dd></dt></dl>
Each line has a unique number between 1 and <i>M</i>. Each endpoint in the plane
has a unique number between 1 and <i>N</i> (

<img width="102" height="32" align="MIDDLE" border="0" src="685img4.gif" alt="$0 < N \le 400$">), where <i>N</i> is the total
number of endpoints. A line segment is represented by its two endpoints (<i>n</i><sub><i>i</i></sub>,
<i>n</i><sub><i>j</i></sub>). Let <em>height(</em><i>L</i><em>)</em> be the height of a line segment <i>L</i>.

<p>

<p>
<br>
A <em>path</em> is a sequence of line segments 

<img width="140" height="32" align="MIDDLE" border="0" src="685img5.gif" alt="$L_{C_1}, L_{C2}, \dots,
L_{C_k}$">,
such that <i>k</i> &gt; 1, 

<img width="130" height="32" align="MIDDLE" border="0" src="685img6.gif" alt="$C_i \neq C_j \quad \forall i \neq j$">,
<i>L</i><sub><i>C</i><sub><i>i</i></sub></sub>
intersects with 

<i>L</i><sub><i>C</i><sub></sub><55>><i>i</i>+1</55></sub> for all 

<img width="75" height="32" align="MIDDLE" border="0" src="685img7.gif" alt="$1 \le i < k$">,
one endpoint of <i>L</i><sub><i>C</i><sub>1</sub></sub>
does not intersect with any other line segments, and one endpoint of <i>L</i><sub><i>C</i><sub><i>k</i></sub></sub>
does not intersect
with any other line segments. The cost between two intersection line segments i
<i>L</i><sub><i>C</i><sub><i>i</i></sub></sub> and 

<i>L</i><sub><i>C</i><sub></sub><59>><i>i</i>+1</59></sub> is
<br><p>
<div align="CENTER">



<img width="224" height="33" src="685img8.gif" alt="\begin{displaymath}\left \vert height(L_{C_i}) - height(L_{C_{i+1}}) \right \vert
\end{displaymath}">
</div>
<br clear="ALL">
<p>

<p>
That is, for example you can image, the number of stairs that one has to climb (up or
down ) by walking from <i>L</i><sub><i>C</i><sub><i>i</i></sub></sub> to 

<i>L</i><sub><i>C</i><sub></sub><63>><i>i</i>+1</63></sub>. The cost of a path 


<img width="140" height="32" align="MIDDLE" border="0" src="685img5.gif" alt="$L_{C_1}, L_{C2}, \dots,
L_{C_k}$">
is
<br><p>
<div align="CENTER">



<img width="210" height="59" src="685img9.gif" alt="\begin{displaymath}k \cdot \Delta + \sum_{i=1}^{k-1} cost(L_{C_i},L_{C_{i+1}}).
\end{displaymath}">
</div>
<br clear="ALL">
<p>

<p>
In the example shown in Fig. 1, <img width="19" height="15" align="BOTTOM" border="0" src="685img1.gif" alt="$\Delta$">
= 25, <i>M</i> = 8, and <i>N</i> = 9. Then


<i>cost</i>(<i>L</i><sub>2</sub>, <i>L</i><sub>3</sub>) = 1 and 

<i>cost</i>(<i>L</i><sub>1</sub>, <i>L</i><sub>6</sub> ) = 8. 

<i>L</i><sub>1</sub>, <i>L</i><sub>4</sub>, <i>L</i><sub>5</sub> is not a path.
There are three paths in the plane. The cost for the path 

<i>L</i><sub>1</sub>, <i>L</i><sub>6</sub>, <i>L</i><sub>7</sub>, <i>L</i><sub>8</sub> 
is 109. The cost for the path 

<i>L</i><sub>1</sub>, <i>L</i><sub>4</sub>, <i>L</i><sub>5</sub> ,<i>L</i><sub>8</sub> is 131. The cost for the
path <i>L</i><sub>2</sub>, <i>L</i><sub>3</sub> is 51. Hence <i>L</i><sub>2</sub>, <i>L</i><sub>3</sub> is the path with the least cost. 

<p>
You may also assume there is at least one path in the plane. Write a program to
find the least cost among all paths.  

<p>

<h2><font color="#0070E8"><a name="SECTION0001001000000000000000">
Input</a>&nbsp;</font>
</h2>
The first line is <i>l</i>, the number of test cases. The first three lines of test
case #<i>i</i> are <i>M</i><sub><i>i</i></sub>, <i>N</i><sub><i>i</i></sub> and <img width="25" height="32" align="MIDDLE" border="0" src="685img10.gif" alt="$\Delta_i$">
which are the numbers of line segments
and endpoints, and the overhead, respectively. The following <i>M</i><sub><i>i</i></sub> lines each
contains the two endpoints of each line segment, starting from <i>L</i><sub>1</sub> to
<i>L</i><sub><i>M</i><sub><i>i</i></sub></sub>, and its height. 

<p>
Each line segment is represented by three integers, separated by blanks.

<p>

<h2><font color="#0070E8"><a name="SECTION0001002000000000000000">
Output</a>&nbsp;</font>
</h2>
Contains <i>l</i> lines. The <i>i</i><sup><i>th</i></sup> line contains the least cost of all paths in
the <i>i</i><sup><i>th</i></sup> test case.

<p>
<div align="CENTER">

<img src="p685.gif">

<p>

<p>
<br>
Fig. 1: An example of 8 straight lines with 9 endpoints.
</div>

<p>

<h2><font color="#0070E8"><a name="SECTION0001003000000000000000">
Sample Input</a>&nbsp;</font>
</h2>

<p>
<pre>
2
8
9
25
1 2 1
8 9 10
7 8 9
1 4 2
4 5 20
1 3 9
3 5 9
5 6 8
6
6
21
1 2 1
1 4 2
4 5 20
1 3 9
3 5 9
5 6 8
</pre>

<p>

<h2><font color="#0070E8"><a name="SECTION0001004000000000000000">
Sample Output</a>&nbsp;</font>
</h2>
				
<pre>
51
93
</pre>

<p>

<p>
<br><hr>
<address>
<i>Miguel Revilla</i>
<br><i>2000-08-14</i>
</address>
</body>
</html>

