

<html>
<head>
<title>You Who?</title>
<meta name="description" content="You Who?">
<meta name="keywords" content="htmlatex">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="STYLESHEET" href="htmlatex.css">
</head>
<body lang="EN" bgcolor="#FFFFFF">



<p>On the first day of first grade at Friendly Elementrary School, it is customary for each student to
spend one minute talking to every classmate that he or she does not already know. When student
Bob sees an unfamilar face, he says ``You who?'' A typical response is ``Me Charlie, you who?''
Then Bob says, ``Me Bob!'' and they talk for a minute. It's very cute. Then, after a minute, they
part and each looks for another stranger to greet. This takes time. In class of twenty
mutual strangers, it takes 19 minutes; time that, according to teachers, could be better spent learning
the alphabet. Of course, it is rare to have a first grade class where nobody knows anyone else; there
are neighbors and playmates who already know each other, so they don't have to go through the
get-to-know-you minutes with each other.

<p>The two first grade teachers have requested that, to save time, students be allocated to 
their two classes so that the difference in the sizes of the classes is at most one, 
and the maximal number of introductions per person is as small as possible. 
There are no more than 24 students in the incoming first grade class.</p>

<p>How can the assignment of students to classes be made? Your job is to write the software that answers the question.</p>


<h2><font color="#0070E8"><a name="SECTION0001001000000000000000">Input</a></font></h2>
The input data consists of a number of test cases. Subsequent cases are separated by a single blank line.

<p>The descriptions of the test cases follow. The first line of a test case description contains 
one integer N (1 <= n=""></=><= 24),="" denoting="" the="" total="" number="" students.="" each="" of="" the="" next="" n="" lines="" contains="" the="" record="" about="" one="" student's="" friendships,="" represented="" as="" lists="" of="" numbers.=""></=><p>If there are N students, then they are represented by the numbers 1 to N. The record for
a single student includes, first, his/her student identification number (1 to N), then
the number of his/her acquaintances, then a list of them in no particular order. So, for example, this record

<pre>
17 4 5 2 14 22
</pre>

<p>
indicates that student 17 knows 4 students: 5, 2, 14 and 22. 

<p>
The following test case
<pre>
4
1 2 3 4
2 2 3 4
3 2 1 2
4 2 1 2
</pre>

indicates that 1 doesn't know 2, and 3 doesn't know 4, but all other pairs know each other.

<p>
The input data has been checked for consistency, so that if A knows B, then B knows A.

<p>

<h2><font color="#0070E8"><a name="SECTION0001002000000000000000">
Output</a>&nbsp;</font>
</h2>

<p><b>For each test case, the output must follow the description below. The outputs of two consecutive cases will be separated by a blank line. </b></p>

Your output for each case should contain three lines.
In the first line there should be the maximal number of introductions per person 
in the best possible legal class assignment. 

The second and third lines describe the two class 
enrollments that achieves that bound. 

An enrollment for each class
is represented by the number of students 
in the class, and then a list of the students in the class, 
in increasing order separated by single spaces. 

If there is more than one such assignment, anyone will do.

<h2><font color="#0070E8"><a name="SECTION0001003000000000000000">
Sample Input</a>&nbsp;</font>
</h2>

<p>
<pre>
4
1 2 3 4
2 2 3 4
3 2 1 2
4 2 1 2

2
1 1 2
2 1 1
</pre>

<h2><font color="#0070E8"><a name="SECTION0001004000000000000000">
Sample Output</a>&nbsp;</font>
</h2>
				
<pre>
0
2 1 3
2 2 4

0
1 1
1 2
</pre>

<hr>
<address>
<i>Miguel A. Revilla</i>
<br><i>2000-01-17</i>
</address>
</body>
</html>

