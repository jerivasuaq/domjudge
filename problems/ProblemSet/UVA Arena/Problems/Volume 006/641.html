

<html>
<head>
<title>Do the Untwist</title>
<meta name="description" content="Do the Untwist">
<meta name="keywords" content="htmlatex">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="STYLESHEET" href="htmlatex.css">
</head>
<body lang="EN" bgcolor="#FFFFFF">

<h1><br clear="ALL"><center><table bgcolor="#0060F0"><tr><td><b><font size="5" color="#C0FFFF">&nbsp;<a name="SECTION0001000000000000000000">
Do the Untwist</a>&nbsp;</font></b></td></tr></table></center>
</h1>

<p>



<b><i>Cryptography</i></b>  deals with methods of secret communication that
transform a message (the  
<b><i>plaintext</i></b>) into a disguised form (the



<b><i>ciphertext</i></b>) so that no one seeing the ciphertext will be able
to  figure out the plaintext except the intended recipient.
Transforming the plaintext to the ciphertext is  


<b><i>encryption</i></b>;
transforming the ciphertext to the plaintext is  


<b><i>decryption</i></b>.
 
<b><i>Twisting</i></b>  is a simple encryption method that requires that the
sender and recipient both agree on a secret key <b><i>k</i></b>, which is a
positive integer.

<p>

<p>
<br>
The twisting method uses four arrays: <em>plaintext</em> and <em>ciphertext</em>
are arrays of characters, and <em>plaincode</em> and <em>ciphercode</em> are
arrays of integers.  All arrays are of length <b><i>n</i></b>, where <b><i>n</i></b> is the
length of the message to be encrypted.  Arrays are origin zero, so the
elements are numbered from 0 to <b><i>n</i> - 1</b>.  For this problem all
messages will contain only lowercase letters, the period, and the
underscore (representing a space).

<p>

<p>
<br>
The message to be encrypted is stored in <em>plaintext</em>.  Given a key
<b><i>k</i></b>, the encryption method works as follows.  First convert the
letters in <em>plaintext</em> to integer codes in <em>plaincode</em> according to
the following rule: `<code>SPMamp</code>_&amp;' = 0, `<tt>a</tt>' = 1, `<tt>b</tt>' = 2, ..., `<tt>z</tt>' = 26,
and `<tt>.</tt>' = 27.  Next, convert each code in <em>plaincode</em> to an
encrypted code in <em>ciphercode</em> according to the following formula: for all
<b><i>i</i></b> from 0 to <b><i>n</i> - 1</b>,

<p>
<br><p>
<div align="CENTER">



<img width="378" height="31" src="641img1.gif" alt="\begin{displaymath}ciphercode[i] = (plaincode[ki \bmod n] - i) \bmod 28.
\end{displaymath}">
</div>
<br clear="ALL">
<p>

<p>
(Here <img width="67" height="32" align="MIDDLE" border="0" src="641img2.gif" alt="$x \bmod y$">
is the positive remainder when <b><i>x</i></b> is divided by <b><i>y</i></b>.
For example, 3 <img width="40" height="16" align="BOTTOM" border="0" src="641img3.gif" alt="$\bmod$">
7 = 3, 22 <img width="40" height="16" align="BOTTOM" border="0" src="641img3.gif" alt="$\bmod$">
8 = 6, and -1 <img width="40" height="16" align="BOTTOM" border="0" src="641img3.gif" alt="$\bmod$">
28 = 27.  You
can use the C `<tt>%</tt>' operator or Pascal `<tt>mod</tt>' operator to compute
this as long as you add <b><i>y</i></b> if the result is negative.)

<p>
Finally, convert the codes in <em>ciphercode</em> back to letters in
<em>ciphertext</em> according to the rule listed above.  The final twisted
message is in <em>ciphertext</em>. Twisting the message ``<tt>cat</tt>" using the key 5 yields the following:

<p>

<p>
<br>

<div align="CENTER">
<table cellpadding="3" border="1">
<tr><td align="LEFT">Array</td>
<td align="CENTER">0</td>
<td align="CENTER">1</td>
<td align="CENTER">2</td>
</tr>
<tr><td align="LEFT"><em> plaintext</em></td>
<td align="CENTER">'c'</td>
<td align="CENTER">'a'</td>
<td align="CENTER">'t'</td>
</tr>
<tr><td align="LEFT"><em> plaincode</em></td>
<td align="CENTER">3</td>
<td align="CENTER">1</td>
<td align="CENTER">20</td>
</tr>
<tr><td align="LEFT"><em> ciphercode</em></td>
<td align="CENTER">3</td>
<td align="CENTER">19</td>
<td align="CENTER">27</td>
</tr>
<tr><td align="LEFT"><em> ciphertext</em></td>
<td align="CENTER">'c'</td>
<td align="CENTER">'s'</td>
<td align="CENTER">'.'</td>
</tr>
</table></div>

<p>

<p>
<br>
Your task is to write a program that can <em>untwist</em> messages,
<em>i.e.</em>, convert the ciphertext back to the original
plaintext given the key <b><i>k</i></b>.  For example, given the key 5 and
ciphertext `<tt>cs.</tt>', your program must output the plaintext `<tt>cat</tt>'.

<p>

<h2><font color="#0070E8"><a name="SECTION0001001000000000000000">
Input</a>&nbsp;</font>
</h2>
The input file contains one or more test cases, followed by a line
containing only the number 0 that signals the end of the file.
Each test case is on a line by itself and consists of the key <b><i>k</i></b>, a
space, and then a twisted message containing at least one and at most 70
characters.  The key <b><i>k</i></b> will be a positive integer not greater than
300.

<p>

<h2><font color="#0070E8"><a name="SECTION0001002000000000000000">
Output</a>&nbsp;</font>
</h2>
For each test case, output the untwisted message on a line
by itself.

<p>

<b>Note:</b> you can assume that untwisting a message always yields
a unique result.  (For those of you with some knowledge of basic number
theory or abstract algebra, this will be the case provided that the
greatest common divisor of the key <b><i>k</i></b> and length <b><i>n</i></b> is 1, which it
will be for all test cases.)

<p>

<h2><font color="#0070E8"><a name="SECTION0001003000000000000000">
Sample Input</a>&nbsp;</font>
</h2>

<p>
<pre>
5 cs.
101 thqqxw.lui.qswer
3 b_ylxmhzjsys.virpbkr
0
</pre>

<p>

<h2><font color="#0070E8"><a name="SECTION0001004000000000000000">
Sample Output</a>&nbsp;</font>
</h2>
				
<pre>
cat
this_is_a_secret
beware._dogs_barking
</pre>

<p>

<p>
<br><hr>
<address>
<i>Miguel A. Revilla</i>
<br><i>2000-01-17</i>
</address>
</body>
</html>

