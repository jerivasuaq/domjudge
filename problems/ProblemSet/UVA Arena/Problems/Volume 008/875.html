<html>
<head>
<title>ACM - 3ª Sessão - 4º Problema</title>
<style>a:hover {color:#FA1F00}</style>
</head>

<body>



<font color="#000000" face="Arial" size="2">

<p align="center"><b><font size="3" face="Arial" color="#000000">Monopoly
</font></b></p>

<p> 
<b><font size="3"><a name="back">Background</a></font></b></p>

<p>&nbsp;&nbsp; In the current business world there are many situations of participation
of a company in the capital of another, of cross-participations and of partnerships.
The amount of capital owned by each participant determines the number of votes. An entity
possessing 50%+1 votes controls the company. This entity may be a single company or a
partnership of several companies. To make the process more complex, a company may control
another indirectly, because if company A controls company B, and B controls C, then A
controls C. Thus it is not always clear who controls what.<br>
&nbsp;&nbsp; In order to understand the power relationships among companies, a knowledgeable stock
exchange broker writes down some facts of the form A > B, meaning company A controls company B.
He also writes more generic facts like A<sub>1</sub> … A<sub>n</sub> > B meaning that a
possible partnership ofcompanies A<sub>1</sub> … A<sub>n</sub> is able to control B. Due to
the empiric process used, the set of facts may include many redundancies, of two types:<br>
&nbsp;&nbsp; Type 1: if A B C > D is a fact but it can be concluded from the set of facts
that A and B together are enough to control D (directly or indirectly), then C can be
deleted from the former fact because it is irrelevant.<br>
&nbsp;&nbsp; Type 2: if there is a fact A > B but it can be concluded just from the other
facts that A controls B, then A > B may be deleted because it is redundant.<br>
&nbsp;&nbsp; To get a clearer picture of the essential relationships, an analyst would
like to have a minimal version of the set of facts without redundancies, but also without
loosing information. There may be several alternative minimal sets of facts.
 </p>

<p> 
<b><font size="3"><a name="problem">Problem</a></font></b></p>

<p>&nbsp;&nbsp; Given an initial set of facts of the form A<sub>1</sub> … A<sub>n</sub> > B
a minimal set is an equivalent set that contains neither redundancies of type 1 nor of type 2.
Which is the number of facts of the smallest minimal set?</p>

<p>
<b><font size="3"><a name="input">Input</a></font></b></p>
<b>
The input begins with a single positive integer on a line by itself indicating
the number of the cases following, each of them as described below.
This line is followed by a blank line, and there is also a blank line between
two consecutive inputs.
</b>
<p>
<p>

<p>&nbsp;&nbsp; The first line of the input contains the integer number N of facts. Each of
the following N lines contains a string of k (1&lt;= k &lt;= 26) capital letters, the symbol >
and a single capital letter. Each capital letter represents a company.  

<p>
<b><font size="3"><a name="output">Output</a></font></b></p>
<b>
For each test case, the output must follow the description below.
The outputs of two consecutive cases will be separated by a blank line.
</b>
<p>
<p>

<p>&nbsp;&nbsp; One line containing the number of facts of the smallest minimal set.


<p><b>Sample Input</b><br>1<br><br>11<br>AB>C<br>C>A<br>BC>D<br>ACD>B<br>D>E<br>D>G<br>BE>C<br>CG>B<br>
CG>D<br>CE>A<br>CE>G

<p><b>Sample Output</b><br>8

<p>&nbsp;</p>

</font>
</body>

</html>
