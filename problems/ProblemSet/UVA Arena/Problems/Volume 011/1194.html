<p>
As we all know, machine scheduling is a very classical problem in computer science and has been studied for a very long history. Scheduling problems differ widely in the nature of the constraints that must be satisfied and the type of schedule desired. Here we consider a 2-machine scheduling problem.

<p>
There are two machines <span class="MATH"><i>A</i></span>
<tex2html_verbatim_mark> and <span class="MATH"><i>B</i></span>
<tex2html_verbatim_mark>. Machine <span class="MATH"><i>A</i></span>
<tex2html_verbatim_mark> has <span class="MATH"><i>n</i></span>
<tex2html_verbatim_mark> kinds of working modes, which is called <span class="MATH"><i>mode</i><sub>0</sub></span>
<tex2html_verbatim_mark>, <span class="MATH"><i>mode</i><sub>1</sub></span>
<tex2html_verbatim_mark>, <span class="MATH">...</span>
<tex2html_verbatim_mark>, 
<span class="MATH"><i>mode</i><sub>n-1</sub></span>
<tex2html_verbatim_mark>, likewise machine <span class="MATH"><i>B</i></span>
<tex2html_verbatim_mark> has <span class="MATH"><i>m</i></span>
<tex2html_verbatim_mark> kinds of working modes, <span class="MATH"><i>mode</i><sub>0</sub></span>
<tex2html_verbatim_mark>, <span class="MATH"><i>mode</i><sub>1</sub></span>
<tex2html_verbatim_mark>, <span class="MATH">...</span>
<tex2html_verbatim_mark> , 
<span class="MATH"><i>mode</i><sub>m-1</sub></span>
<tex2html_verbatim_mark>. At the beginning they are both work at <span class="MATH"><i>mode</i><sub>0</sub></span>
<tex2html_verbatim_mark>.

<p>
For <span class="MATH"><i>k</i></span>
<tex2html_verbatim_mark> jobs given, each of them can be processed in either one of the two machines in particular mode. For example, job 0 can either be processed in machine <span class="MATH"><i>A</i></span>
<tex2html_verbatim_mark> at <span class="MATH"><i>mode</i><sub>3</sub></span>
<tex2html_verbatim_mark> or in machine <span class="MATH"><i>B</i></span>
<tex2html_verbatim_mark> at <span class="MATH"><i>mode</i><sub>4</sub></span>
<tex2html_verbatim_mark>, job 1 can either be processed in machine <span class="MATH"><i>A</i></span>
<tex2html_verbatim_mark> at <span class="MATH"><i>mode</i><sub>2</sub></span>
<tex2html_verbatim_mark> or in machine <span class="MATH"><i>B</i></span>
<tex2html_verbatim_mark> at <span class="MATH"><i>mode</i><sub>4</sub></span>
<tex2html_verbatim_mark>, and so on. Thus, for job i, the constraint can be represent as a triple <span class="MATH">(<i>i</i>, <i>x</i>, <i>y</i>)</span>
<tex2html_verbatim_mark>, which means it can be processed either in machine <span class="MATH"><i>A</i></span>
<tex2html_verbatim_mark> at <span class="MATH"><i>mode</i><sub>x</sub></span>
<tex2html_verbatim_mark>, or in machine <span class="MATH"><i>B</i></span>
<tex2html_verbatim_mark> at <span class="MATH"><i>mode</i><sub>y</sub></span>
<tex2html_verbatim_mark>.

<p>
Obviously, to accomplish all the jobs, we need to change the machine's working mode from time to time, but unfortunately, the machine's working mode can only be changed by restarting it manually. By changing the sequence of the jobs and assigning each job to a suitable machine, please write a program to minimize the times of restarting machines. 

<p>

<h2><font size="4" color="#ff0000"><a name="SECTION0001001000000000000000">
Input</a>&nbsp;</font>
</h2>

<p>
The input file for this program consists of several configurations. The first line of one configuration contains three positive integers: <span class="MATH"><i>n</i></span>
<tex2html_verbatim_mark>, <span class="MATH"><i>m</i></span>
<tex2html_verbatim_mark> 
<span class="MATH">(<i>n</i>, <i>m</i> &lt; 100)</span>
<tex2html_verbatim_mark> and <span class="MATH"><i>k</i></span>
<tex2html_verbatim_mark> 
<span class="MATH">(<i>k</i> &lt; 1000)</span>
<tex2html_verbatim_mark>. The following <span class="MATH"><i>k</i></span>
<tex2html_verbatim_mark> lines give the constrains of the <span class="MATH"><i>k</i></span>
<tex2html_verbatim_mark> jobs, each line is a triple: <span class="MATH"><i>i</i>, <i>x</i>, <i>y</i></span>
<tex2html_verbatim_mark>.

<p>
The input will be terminated by a line containing a single zero.

<p>

<h2><font size="4" color="#ff0000"><a name="SECTION0001002000000000000000">
Output</a>&nbsp;</font>
</h2>

<p>
The output should be one integer per line, which means the minimal times of restarting machine.

<p>

<h2><font size="4" color="#ff0000"><a name="SECTION0001003000000000000000">
Sample Input</a>&nbsp;</font>
</h2>

<p>
<pre>
5 5 10
0 1 1
1 1 2
2 1 3
3 1 4
4 2 1
5 2 2
6 2 3
7 2 4
8 3 3
9 4 3
0
</pre> 

<p>

<h2><font size="4" color="#ff0000"><a name="SECTION0001004000000000000000">
Sample Output</a>&nbsp;</font>
</h2>

<p>
<pre>
3
</pre> 

<p>
</tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark>