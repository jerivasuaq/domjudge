

<html>
<head>
<title>Molecules</title>
<meta name="description" content="Molecules">
<meta name="keywords" content="htmlatex">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<link rel="STYLESHEET" href="htmlatex.css">
</head>
<body lang="EN" bgcolor="#FFFFFF">
 <h1><br clear="ALL"><center><table bgcolor="#0060F0"><tr><td><b><font size="5" color="#C0FFFF">&nbsp;<a name="SECTION0001000000000000000000">Molecules</a></font>&nbsp;</b></td></tr></table></center></h1>
<p>
In this abstraction from a molecular engineering problem associated with
developing a synthetic fuel, we
are given four, equal-length, molecular chains that are to form a super
molecule. In the simplified two-dimensional model used here, 
the super molecule is formed as an interlocking rectangular arrangement of
the four given molecular chain strands. The interlocking feature is the
sharing of a common molecule between pairs of chains.
<p>
<p>
To illustrate, suppose we have the four, length-twelve, molecular chains:
<p>
<pre>                      O I M D I H E I A F N L
                      C H J D B J M H P J K D
                      L C B J O J G I E K B O
                      K A I N L H L O L B E J</pre>
<p>
These can be placed in the interlocking arrangements:
<p>
<pre>                            O           L
                            I           C
                            M           B
                      C H J D B J M H P J K D
                            I           O
                            H           J
                            E           G
                            I           I
                            A           E
                            F           K
                      K A I N L H L O L B E J
                            L           O</pre>
<p>
-OR-
<p>
<pre>                                    O     C
                                    I     H
                                    M     J
                                    D     D
                      L C B J O J G I E K B O
                                    H     J
                                    E     M
                                K A I N L H L O L B E J
                                    A     P
                                    F     J
                                    N     K
                                    L     D</pre>
<p>
In this problem, we have some constraints on the arrangements being sought:
<p>
<dl compact=""><dt><strong>1)</strong>
<dd> Any of the four chains can be placed in any of the super molecule's
four, general, horizontal or vertical slots, as in the illustrations above.
<dt><strong>2)</strong>
<dd> If a chain is placed in one of the two horizontal slots, it must
keep the same left-to-right orientation
it had in the original chain listing.
That is, <i>it can't be flipped end-for-end</i>.
<dt><strong>3)</strong>
<dd> If a chain is placed in one of the two vertical slots, its
left-to-right orientation in the original chain
listing must match its top-to-bottom orientation in the slot. It can't be
flipped end-for-end from this orientation.
<dt><strong>4)</strong>
<dd> The enclosed rectangular region at the center of the super molecule
must have as large an area as
possible, and the area cannot be zero. (The large-area constraint arises
from a fuel-volatility criterion for the arrangement.
The non-zero area constraint arises because neither the vertically nor the
horizontally oriented chains can lie immediately next to each other without
producing side-effects we're not considering.)
<p>
The area is measured as the count of vacant character positions within
the enclosed rectangle of the
super molecule. The area counts of the two super molecules illustrated above
are thirty (30) and four (4).
<dt><strong>5)</strong>
<dd> The fore and aft tails of each chain extending beyond the super
molecule's central interlocked rectangle must have a minimum length
of one chain element. That is, none of the four original chains
can have either its first or its last element as part of the
interlocking-rectangle boundary.
<p>
 </dd></dt></dd></dt></dd></dt></dd></dt></dd></dt></dl><h2><font color="#0070E8"><a name="SECTION0001001000000000000000">Input</a></font></h2>
<p>
The input consists of a series of data sets. Each data set consists of four
molecular chains of 12 fixed elements each.
These 12 elements are given as contiguous capital letters. The molecule
designators within
the chains will be restricted to the sixteen letters, <tt>A...P</tt>. The first
letter of a chain will appear as the first character on an input line.
<p>
<p>
The first molecule designator within the first chain of a data set will
be the letter <tt>&quot;Q&quot;</tt> to indicate the end of data.
<p>
<h2><font color="#0070E8"><a name="SECTION0001002000000000000000">Output</a></font></h2>
<p>
A line with a single integer is to be emitted for each input data set
encountered. This integer is the maximum area enclosed by any legitimate
arrangement of the four chains.
<p>
<p>
Use the output value zero (0) to indicate that no legitimate super molecule
could be formed for a givendata set.
<p>
<p>
The first digit of an output value should be the first character on a
line.
<p>
<h2><font color="#0070E8"><a name="SECTION0001003000000000000000">Sample Input</a></font></h2>
<p>
<pre>CDBADCBBEFEF
DACCBADAFEAB
EFBDCAADBDCD
ABCDABCDABCD
DACCBADAFEAB
EFBDCAADBDCD
ABCDABCDABCD
CDBADCBBEFEF
ABABABABABAB
CDCDCDCDCDCD
EEEEEEEEEEEE
FFFFFFFFFFFF
ABAAAAAAAABA
CBCCCCCCCCBC
DBDDDDDDDDBD
EBEEEEEEEEBE
ABBBBBBBBBBA
ACCCCCCCCCCA
ADDDDDDDDDDA
AEEEEEEEEEEA
BBBABBBABBBB
CCACCCACCCCC
DDDDADDADDDD
EEAEEAEEEEEE
Q</pre>
<p>
<h2><font color="#0070E8"><a name="SECTION0001004000000000000000">Sample Output</a></font></h2>
<p>
<pre>48
48
0
64
0
6</pre>
<p>
</body>
</html>
