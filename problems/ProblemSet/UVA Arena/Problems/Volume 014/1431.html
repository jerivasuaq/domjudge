
<p>

<p>
<br>
What do researchers working at ICPC (Institute for Cryptographic Programming and Computing) do for fun? Well, as you probably have expected, in addition to solving algorithm-related problems on online judges, they also like to toy with various cryptographic schemes. Recently one of the researchers, Tom, has become interested in RSA algorithm implementations used in handheld devices. 

<p>

<p>
<br>
<span class="textit">Note that the description of the general RSA algorithm is as follows:</span> 

<p>
<dl compact="">
<dt>1)</dt>
<dd><span class="textit">Choose two distinct prime numbers <span class="MATH"><i>p</i></span>
<tex2html_verbatim_mark> and <span class="MATH"><i>q</i></span>
<tex2html_verbatim_mark>, and let <span class="MATH"><i>n</i> = <i>pq</i></span>
<tex2html_verbatim_mark>;</tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></span> 
</dd>
<dt>2)</dt>
<dd><span class="textit">Choose an integer <span class="MATH"><i>e</i></span>
<tex2html_verbatim_mark> such that 
<span class="MATH">gcd(<i>e</i>,(<i>p</i> - 1)(<i>q</i> - 1) = 1</span>
<tex2html_verbatim_mark>;</tex2html_verbatim_mark></tex2html_verbatim_mark></span> 
</dd>
<dt>3)</dt>
<dd><span class="textit">Compute the integer <span class="MATH"><i>d</i></span>
<tex2html_verbatim_mark> that satisfies the congruence relation 
<span class="MATH"><i>de</i> <img width="18" height="16" align="BOTTOM" border="0" src="4353img1.png" alt="$ \equiv$"> 1( mod(<i>p</i> - 1)(<i>q</i> - 1))</span>
<tex2html_verbatim_mark>.</tex2html_verbatim_mark></tex2html_verbatim_mark></span>
</dd>
</dl>

<p>
<span class="textit">Then, if person A wants to give person B a way to send an encrypted message to him, A can follow the above steps and release <span class="MATH">(<i>n</i>, <i>e</i>)</span>
<tex2html_verbatim_mark> as his public key. Upon receiving A's public key, B can simply encrypt message <span class="MATH"><i>x</i></span>
<tex2html_verbatim_mark> 
<span class="MATH">(0<img width="18" height="31" align="MIDDLE" border="0" src="4353img2.png" alt="$ \le$"><i>x</i> &lt; <i>n</i>)</span>
<tex2html_verbatim_mark> by computing 
<span class="MATH"><i>y</i> = <i>x</i><sup>e</sup> mod <i>n</i></span>
<tex2html_verbatim_mark>. This would result in a message which ideally only A could decrypt with his private key <span class="MATH"><i>d</i></span>
<tex2html_verbatim_mark>: 
<span class="MATH"><i>x</i> = <i>y</i><sup>d</sup> mod <i>n</i></span>
<tex2html_verbatim_mark>.</tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></span>

<p>

<p>
<br>
As the computation power of handheld devices is usually limited, a relatively small <span class="MATH"><i>e</i></span>
<tex2html_verbatim_mark> is usually used to encrypt data. However this can lead to great security risks. For example, it is quite simple to recover <span class="MATH"><i>p</i></span>
<tex2html_verbatim_mark> and <span class="MATH"><i>q</i></span>
<tex2html_verbatim_mark> (i.e., factor <span class="MATH"><i>n</i></span>
<tex2html_verbatim_mark>) when you have both the public key <span class="MATH">(<i>n</i>, <i>e</i>)</span>
<tex2html_verbatim_mark> and the private key <span class="MATH"><i>d</i></span>
<tex2html_verbatim_mark>. Could you help Tom write a program to demonstrate this?

<p>

<h2><font size="4" color="#ff0000"><a name="SECTION0001001000000000000000">
Input</a>&nbsp;</font>
</h2>

<p>
There are multiple test cases in the input file. 

<p>
Each test case contains three integers, <span class="MATH"><i>n</i></span>
<tex2html_verbatim_mark>, <span class="MATH"><i>d</i></span>
<tex2html_verbatim_mark>, and <span class="MATH"><i>e</i></span>
<tex2html_verbatim_mark> (
<span class="MATH"><i>n</i><img width="18" height="31" align="MIDDLE" border="0" src="4353img2.png" alt="$ \le$">10<sup>100</sup>, 3<img width="18" height="31" align="MIDDLE" border="0" src="4353img2.png" alt="$ \le$"><i>e</i><img width="18" height="31" align="MIDDLE" border="0" src="4353img2.png" alt="$ \le$">31</span>
<tex2html_verbatim_mark>). All three integers are given without any preceding zeros. It is guaranteed that all numbers satisfy the condition as given in the problem statement. 

<p>
Two successive test cases are separated by a blank line. A case with <span class="MATH"><i>n</i> = 0</span>
<tex2html_verbatim_mark>, <span class="MATH"><i>d</i> = 0</span>
<tex2html_verbatim_mark> and <span class="MATH"><i>e</i> = 0</span>
<tex2html_verbatim_mark> indicates the end of the input file, and should not be processed by your program. 

<p>

<h2><font size="4" color="#ff0000"><a name="SECTION0001002000000000000000">
Output</a>&nbsp;</font>
</h2>

<p>
For each test case, please print two prime numbers, <span class="MATH"><i>p</i></span>
<tex2html_verbatim_mark> and <span class="MATH"><i>q</i></span>
<tex2html_verbatim_mark>, such that <span class="MATH"><i>n</i> = <i>pq</i></span>
<tex2html_verbatim_mark> and <span class="MATH"><i>p</i> &lt; <i>q</i></span>
<tex2html_verbatim_mark>, in the format as illustrated below. 

<p>

<h2><font size="4" color="#ff0000"><a name="SECTION0001003000000000000000">
Sample Input</a>&nbsp;</font>
</h2>

<p>
<pre>
55 27 3 

290203 168101 5 

0 0 0
</pre>

<p>

<h2><font size="4" color="#ff0000"><a name="SECTION0001004000000000000000">
Sample Output</a>&nbsp;</font>
</h2>

<p>
<pre>
Case #1: 5 11 
Case #2: 29 10007
</pre>

<p>
</tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark>