

<html>
<head>
<title>Word Search Wonder</title>
<meta name="description" content="Word Search Wonder">
<meta name="keywords" content="htmlatex">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="STYLESHEET" href="htmlatex.css">
</head>
<body lang="EN" bgcolor="#FFFFFF">

<h1><br clear="ALL"><center><table bgcolor="#0060F0"><tr><td><b><font size="5" color="#C0FFFF">&nbsp;<a name="SECTION0001000000000000000000">
Word Search Wonder</a>&nbsp;</font></b></td></tr></table></center>
</h1>

<p>
Word search is a game enjoyed by all ages. The basic idea is to find certain specified words
within a given matrix of letters.

<p>
One interesting means of constructing a word search matrix is to take some written text (in
upper case), strip out all but the characters <tt>A-Z</tt>, and format the resulting sequence of characters
into columns of <i>s</i> characters. That is, taking <i>s</i> = 9 and given the text

<p>

<p>
<br>
Our revels now are ended. These our actors, 
<p>
As I foretold you, were all spirits and 
<p>
Are melted into air, into thin air: 
<p>
And, like the baseless fabric of this vision, 
<p>
The cloud-capp'd towers, the gorgeous palaces, 
<p>
The solemn temples, the great globe itself, 
<p>
Ye all which it inherit, shall dissolve 
<p>
And, like this insubstantial pageant faded, 
<p>
Leave not a rack behind. We are such stuff 
<p>
As dreams are made on, and our little life 
<p>
Is rounded with a sleep. 
<p>

<p>
<br>
We obtain the following word-search matrix:

<p>
<pre>
          ONERIYLNEIITSFODEGCESGLHEDNSNAEAWSEDRFEE
          UODAFOSDDNRHSTNCREEMTLFIRIDITNACETAELEDE
          RWTCOUPAITAEFHTASOSNHOYCISLNITVKAUMOIIWP
          RAHTRWIRNONBAIHPTUTTEBEHTSISAFEBRFSNTSI
          EREOEERETTDABSEPHSHEGEAISOKULANEEFAATRT
          VESRTRIMOHLSRVCDEPEMRIATHLEBPDOHSARNLOH
          EEESOETEAIIEIILTGASPETLIAVTSAETIUSEDEUA
          LNOALASLINKLCSOOOLOLASLNLEHTGDANCDMOLNS
          SDUSDLATRAEEOIUWRALETEWHLAIAELRDHRAUIDL
</pre>

<p>
We can now search this matrix for words. For example, the word ``<tt>SAFE</tt>'' can be found starting
at lexicographic position 246 and running eastward in the text
(by lexicographic position we mean the numerical position with the search matrix when counting consecutively
and column-wise from the first character, which is position 0).
Since, running row-wise, we
are looking at every <i>s</i>'th character, the value of <i>s</i> is sometimes called a <em>skip</em> value.

<p>

<p>
<br>
For this problem, you will be given search words, a search text, and a skip value. Your job
(well, really, your program's job) is to find the location of each of the search words within the
search text, formatted into a search matrix according to the given skip value.

<p>

<h2><font color="#0070E8"><a name="SECTION0001001000000000000000">
Input</a>&nbsp;</font>
</h2>
The first line of the input is an integer K, then a blank line followed by K datasets. There is a blank line between datasets.

<p>The first line of each dataset contains a single integer specifying the skip value to use in doing the
word search. The second line will contain a single integer <i>m</i> specifying the number of words to
search for. The next <i>m</i> lines will contain the words to search for, one word per line. The words
will be given in all uppercase. No word will be more than 32 characters in length. There will
be a maximum of 128 search words. After the search words will be a line containing a single
integer <i>n</i> giving the number of lines in the search text. The next <i>n</i> lines contain the search text.

<p>

<p>
<br>
No line of search text will be more than 128 characters long. All characters in the text will be
upper case. There will be a maximum of 5452 lines.(The number of lines in Hamlet.)

<p>

<h2><font color="#0070E8"><a name="SECTION0001002000000000000000">
Output</a>&nbsp;</font>
</h2>
Each line of output should contain a search word, the lexicographical location of the first character of the word in the search text, and its orientation (the direction in which the rest of
characters are oriented with respect to the first character). 

<p>
Valid directions are <tt>N</tt>, <tt>NE</tt>, <tt>E</tt>, <tt>SE</tt>, <tt>S</tt>,
<tt>SW</tt>, <tt>W</tt>, and <tt>NW</tt>, in that order of precedence, indicating text running in the corresponding directions within the word search
text matrix. If a word occurs more than once in the search matrix, you should print out only the
location with the lowest lexicographical position of the first
letter. The words in the output should be ordered as given in the input.
Each line of output should contain the search word, followed by a space, then the lexicographic
position of the word, followed by another space, and finally the direction that word runs in
the search text. If a word is not found in the search matrix, the line should contain the word
followed by a space and then the text
<tt>NOT FOUND</tt>

<p>Print a blank line between datasets.

<h2><font color="#0070E8"><a name="SECTION0001003000000000000000">
Sample Input</a>&nbsp;</font>
</h2>
<pre>
1

9
5
SAFE
TOES
SHAKE
SPEARE
GLOBE
11
OUR REVELS NOW ARE ENDED. THESE OUR ACTORS,
AS I FORETOLD YOU, WERE ALL SPIRITS, AND
ARE MELTED INTO AIR, INTO THIN AIR:
AND, LIKE THE BASELESS FABRIC OF THIS VISION,
THE CLOUD-CAPP'D TOWERS, THE GORGEOUS PALACES,
THE SOLEMN TEMPLES, THE GREAT GLOBE ITSELF,
YEA, ALL WHICH IT INHERIT, SHALL DISSOLVE,
AND, LIKE THIS INSUBSTANTIAL PAGEANT FADED,
LEAVE NOT A RACK BEHIND. WE ARE SUCH STUFF
AS DREAMS ARE MADE ON; AND OUR LITTLE LIFE
IS ROUNDED WITH A SLEEP.
</pre>

<p>

<h2><font color="#0070E8"><a name="SECTION0001004000000000000000">
Sample Output</a>&nbsp;</font>
</h2>
<pre>
SAFE 246 E
TOES 85 SW
SHAKE NOT FOUND
SPEARE NOT FOUND
GLOBE 189 S
</pre>

<br><hr>
<address>
<i>Miguel A. Revilla</i>
<br><i>1998-03-10</i>
</address>
</body>
</html>

