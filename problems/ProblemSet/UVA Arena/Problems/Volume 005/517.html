

<html>
<head>
<title>Word</title>
<meta name="description" content="Word">
<meta name="keywords" content="htmlatex">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="STYLESHEET" href="htmlatex.css">
</head>
<body lang="EN" bgcolor="#FFFFFF">

<h1><br clear="ALL"><center><table bgcolor="#0060F0"><tr><td><b><font size="5" color="#C0FFFF">&nbsp;<a name="SECTION0001000000000000000000">
Word</a>&nbsp;</font></b></td></tr></table></center>
</h1>

<p>
Dr. R. E. Wright's class was studying modified L-Systems. Let us explain necessary details.
As a model let us have words of length <i>n</i> over a two letter alphabet <img width="46" height="34" align="MIDDLE" border="0" src="517img1.gif" alt="$\{a, b\}$">.
The words are cyclic,
this means we can write one word in any of <i>n</i> forms we receive by cyclic shift, whereby the first
and the last letters in the word are considered to be neighbours.

<p>
Rewriting rules rewrite a letter at a position <i>i</i>, depending on letters at the positions 

<i>i</i> - 2, <i>i</i>, <i>i</i>+1.
We rewrite all letters of the word in one step. When we have a given starting word and a set of
rewriting rules a natural question is: how does the word look after s rewriting steps?

<p>
Help Dr. R. E. Wright and write a program which solves this task.

<p>

<h2><font color="#0070E8"><a name="SECTION0001001000000000000000">
Input</a>&nbsp;</font>
</h2>
There are several blocks in the input file, each describing one system. There is an integer
number <i>n</i>, 

2 &lt; <i>n</i> &lt; 16 the length of the input word in the first line. There is a word in the next
line. The word contains only lowercase letters <tt>a</tt> and <tt>b</tt>. There are four characters 

<i>c</i><sub>1</sub> <i>c</i><sub>2</sub> <i>c</i><sub>3</sub> <i>c</i><sub>4</sub> in the
next eight lines. Each quadruple represents one rewriting rule with the following meaning: when
the letter at the position <i>i</i> - 2 is <i>c</i><sub>1</sub> and the letter at the position <i>i</i> is <i>c</i><sub>2</sub> and the letter at the position
<i>i</i> + 1 is <i>c</i><sub>3</sub> then the letter at the position <i>i</i> after rewriting will be <i>c</i><sub>4</sub>. Rewriting rules are correct and
complete. There is an integer number <i>s</i>, 

<img width="155" height="30" align="MIDDLE" border="0" src="517img2.gif" alt="$0 \leY s \leY 2000000000$">,
in the last line of the block.

<p>

<h2><font color="#0070E8"><a name="SECTION0001002000000000000000">
Output</a>&nbsp;</font>
</h2>
There is one line corresponding to each block of the input file. The line contains a word which
we receive after <i>s</i> rewriting steps from the corresponding starting word using given rewriting rules.
As we mentioned above, the word can be written in any of <i>n</i> cyclic shifted forms. The output file
contains the lexicographically smallest word, assuming that <tt>a</tt> &lt; <tt>b</tt>.

<p>

<h2><font color="#0070E8"><a name="SECTION0001003000000000000000">
Sample Input</a>&nbsp;</font>
</h2>

<p>
<pre>
5
aaaaa
aaab
aabb
abab
abbb
baab
babb
bbab
bbbb
1
</pre>

<p>

<h2><font color="#0070E8"><a name="SECTION0001004000000000000000">
Sample Output</a>&nbsp;</font>
</h2>

<p>
<pre>
bbbbb
</pre>

<p>

<p>
</body>
</html>
